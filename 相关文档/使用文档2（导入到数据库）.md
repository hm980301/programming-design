@[TOC](爬取到的数据导入到数据库)
# 一、搭建数据库
## 1. create database doubanbook
![在这里插入图片描述](https://img-blog.csdnimg.cn/0fcc84e27f764093bcb426fec22269ee.png)

## 2. create table
|表名|含义|
|--|--|
|books|原始数据表|
|book_country_num|出版国家表|
|book_publisher_num|出版社表|
|book_presstime_num|出版时间表|
|book_people_title|评论人数top10数据表|
|book_score_num|评分数据表|

```go
CREATE TABLE `doubanbook`.`books` (
  `title` varchar(255) DEFAULT NULL,
  `link` varchar(255) DEFAULT NULL,
  `country` varchar(255) DEFAULT NULL,
  `author` varchar(255) DEFAULT NULL,
  `translator` varchar(255) DEFAULT NULL,
  `publisher` varchar(255) DEFAULT NULL,
  `press_time` int(11) DEFAULT NULL,
  `price` decimal(10,2) DEFAULT NULL,
  `star` float DEFAULT NULL,
  `score` float DEFAULT NULL,
  `people` int(11) DEFAULT NULL,
  `comment` varchar(255) DEFAULT NULL
);
```

```go
CREATE TABLE `doubanbook`.`book_country_num` (
  `country` varchar(255) DEFAULT NULL COMMENT '国家',
  `num` int(11) DEFAULT NULL COMMENT '数量'
) ;
```

```go
CREATE TABLE `doubanbook`.`book_publisher_num` (
  `publisher` varchar(255) DEFAULT NULL COMMENT '出版社',
  `num` int(11) DEFAULT NULL COMMENT '数量'
);

```

```go
CREATE TABLE `doubanbook`.`book_presstime_num` (
  `press_time` int(11) DEFAULT NULL COMMENT '出版时间',
  `num` int(11) DEFAULT NULL COMMENT '数量'
);
```

```go
CREATE TABLE `doubanbook`.`book_people_title` (
  `people` int(11) DEFAULT NULL COMMENT '评论人数',
  `title` varchar(255) DEFAULT NULL COMMENT '书名'
);
```

```go
CREATE TABLE `doubanbook`.`book_score_num` (
  `score` float DEFAULT NULL COMMENT '评分',
  `num` int(11) DEFAULT NULL COMMENT '数量'
);
```
# 二、导入数据
## 1.导入到books
![在这里插入图片描述](https://img-blog.csdnimg.cn/c24d6cd0663d4d3ba10f1068de27777b.png)
## 2.导入book_country_num
![在这里插入图片描述](https://img-blog.csdnimg.cn/d0369adde10245a198d6d1d2ac590991.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/a95a5b580d8d4a19b0f07b7d08107dff.png)
## 3.导入book_publisher_num
![在这里插入图片描述](https://img-blog.csdnimg.cn/8fd9ac2dc5b14b02993da3196e6b8ce9.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/2262fa3b75244d71ae01e09ddd8b5fb6.png)
## 4.导入book_presstime_num
![在这里插入图片描述](https://img-blog.csdnimg.cn/c9b52ac317fb433d8fc30f718bb39eb0.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/aaca84eba9b444688e76a28507ebac21.png)
## 5.导入book_people_title
![在这里插入图片描述](https://img-blog.csdnimg.cn/9894edd14e5a4953b23c4b513acbeb4a.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/185dcf315e2f460a8d49061372649970.png)
## 6.导入book_score_num
![在这里插入图片描述](https://img-blog.csdnimg.cn/92ed388101234de88bd425a8283bbac5.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/a28f8704c29c426890b7b0623553b0ee.png)
# 三、建立连接
```go
	con = pymysql.connect(
    host='172.0.0.1',
    port=3306,
    user='root',
    passwd='xxxxxxxx',
    db='doubanbook',
    charset='utf8'
    )
```
# 四、创建游标
```go
    cur = con.cursor()
    result=cur.fetchall()
```


